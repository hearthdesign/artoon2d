{% extends 'artoon2d_blog/base.html' %}

{% block content %}
    {# Search and filter form #}
    <div class="category-filter">
    <form method="get">
        <input type="text" name="q" placeholder="Search..." value="{{ query }}">
        <select name="category">
            <option value="">All Categories</option>
            {% for cat in categories %}
                {# retain selected category after form submission #}
                <option value="{{ cat.name }}" {% if cat.name == category %}selected{% endif %}>{{ cat.name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Filter</button>
    </form>
</div>
        {% for post in page_obj %}
          <div class="post-card">
            {% if post.image %}
              <img src="{{ post.image.url }}" alt="{{ post.title }}" class="thumbnail">
            {% endif %}
            <h2 id="p-list-title"><a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a></h2>

          </div>
        {% empty %}
          <p>No posts found.</p>
        {% endfor %}

    <button onclick="scrollToTop()" class="scroll-top-btn" id="scrollTopBtn" title="Go to top">â†‘</button>

    {# Pagination controls #}
    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}{% if category %}&category={{ category }}{% endif %}">Previous</a>
        {% endif %}
        {# Current page number and total pages #}
        <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

        {# Next page link #}
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}{% if category %}&category={{ category }}{% endif %}">Next</a>
        {% endif %}
    </div>


    
{% endblock %} 

